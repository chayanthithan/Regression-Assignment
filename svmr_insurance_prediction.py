# -*- coding: utf-8 -*-
"""SVMR_Insurance_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wBE99XncDHgCs5zovJmh-EFhrfsNfkvz
"""

import pandas as pd

dataset = pd.read_csv("/content/insurance_pre.csv");

dataset

dataset = pd.get_dummies(dataset,drop_first=True);

dataset

dataset.columns

independent = dataset[['age', 'bmi', 'children', 'sex_male', 'smoker_yes']]

independent

dependent = dataset[['charges']]

dependent

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split(independent,dependent,test_size=0.20,random_state=0)

x_train

x_test

y_train

y_test



from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
x_train = sc.fit_transform(x_train)
x_test = sc.transform(x_test)

x_train

x_test

from sklearn.svm import SVR
regressor = SVR(kernel = "rbf",C=1000)
regressor.fit(x_train,y_train)

regressor.intercept_

regressor.n_support_

regressor.support_

y_pred = regressor.predict(x_test)

y_pred

from sklearn.metrics import r2_score
r_score = r2_score(y_test,y_pred)

r_score

import pickle
filename = "finalized_model_SVM.sav"
pickle.dump(regressor,open(filename,'wb'))

loaded_model = pickle.load(open('finalized_model_SVM.sav','rb'))

# 19	female	27.900	0	yes	16884.92400
result = loaded_model.predict([[19,27.900,0,0,1]])

result