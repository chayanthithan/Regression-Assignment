# -*- coding: utf-8 -*-
"""Decision_Tree_Insurance_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1CC-B-XCnENGZyVQk0fBW4Ubr_tQLz7Zu
"""

import pandas as pd

dataset = pd.read_csv("/content/insurance_pre.csv")

dataset

dataset = pd.get_dummies(dataset,drop_first=True)

dataset

dataset.info()

dataset.columns

independent = dataset[['age', 'bmi', 'children', 'sex_male', 'smoker_yes']]

dependent = dataset[[ 'charges']]

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split(independent,dependent,test_size=0.20,random_state=0)

from sklearn.tree import DecisionTreeRegressor
regressor = DecisionTreeRegressor()
regressor.fit(x_train,y_train)

from sklearn.tree import DecisionTreeRegressor
regressor = DecisionTreeRegressor(splitter='random')
regressor=regressor.fit(x_train,y_train)

from sklearn.tree import DecisionTreeRegressor,plot_tree
import matplotlib.pyplot as plt

plt.figure(figsize=(20,10))
plot_tree(regressor,filled=True,feature_names=independent.columns if hasattr(independent,'columns') else None,fontsize=10)
plt.title("Visualisation")
plt.show()

y_pred=regressor.predict(x_test)

from sklearn.metrics import r2_score
r_score=r2_score(y_test,y_pred)

r_score

import pickle
filename="finalized_model_Decision_Tree_Insurance_Prediction.sav"
pickle.dump(regressor,open(filename,'wb'))

loaded_model=pickle.load(open("finalized_model_Decision_Tree_Insurance_Prediction.sav",'rb'))
result = loaded_model.predict([[19,27.900,0,0,1]])

result